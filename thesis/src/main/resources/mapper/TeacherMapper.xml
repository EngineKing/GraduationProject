<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thesis.dao.TeacherDao">
    <insert id="addTeacher" parameterType="com.thesis.entity.Teacher" useGeneratedKeys="true" keyProperty="id">
        insert into tb_teacher(
            number, name, gender, age, phone, email, job_title, introduction, subject_id, department_id, user_id
        ) value (
            #{number}, #{name}, #{gender}, #{age}, #{phone}, #{email}, #{jobTitle}, #{introduction}, #{subjectId},#{departmentId},#{userId}
        )
    </insert>
    <select id="getTeacherById" resultType="com.thesis.entity.Teacher">
        select * from tb_teacher where id=#{teacherId}
    </select>
    <delete id="deleteTeacherById">
        delete from tb_teacher where id=#{teacherId}
    </delete>
    <update id="updateTeacher" parameterType="com.thesis.entity.Teacher">
        update tb_teacher set name=#{name},gender=#{gender},age=#{age},phone=#{phone},email=#{email},job_title=#{jobTitle},
        introduction=#{introduction}, subject_id=#{subjectId}, department_id=#{departmentId} where id=#{id}
    </update>
    <select id="pageQuery" resultType="com.thesis.entity.Teacher">
        SELECT * FROM tb_teacher
        <bind name="offset" value="(query.pn-1)*query.ps"></bind>
        <where>
            <if test="teacherForm.number != null and teacherForm.number != ''">
                AND number LIKE CONCAT ('%',#{teacherForm.number},'%')
            </if>
            <if test="teacherForm.name != null and teacherForm.name != ''">
                AND name LIKE CONCAT ('%',#{teacherForm.name},'%')
            </if>
            <if test="teacherForm.jobTitle != null and teacherForm.jobTitle != ''">
                AND job_title LIKE CONCAT ('%',#{teacherForm.jobTitle},'%')
            </if>
            <if test="teacherForm.gender != null and teacherForm.gender != ''">
                AND gender = #{teacherForm.gender}
            </if>
            <if test="teacherForm.subjectId != null and teacherForm.subjectId != ''">
                AND subject_id = #{teacherForm.subjectId}
            </if>
            <if test="teacherForm.departmentId null and teacherForm.departmentId != ''">
                AND department_id = #{teacherForm.departmentId}
            </if>
        </where>
        ORDER BY id DESC
        LIMIT #{offset},#{query.ps}
    </select>
    <select id="pageQueryCount" resultType="java.lang.Integer">
        SELECT Count(*) FROM tb_teacher
        <where>
            <if test="teacherForm.number != null and teacherForm.number != ''">
                AND number LIKE CONCAT ('%',#{teacherForm.number},'%')
            </if>
            <if test="teacherForm.name != null and teacherForm.name != ''">
                AND name LIKE CONCAT ('%',#{teacherForm.name},'%')
            </if>
            <if test="teacherForm.jobTitle != null and teacherForm.jobTitle != ''">
                AND job_title LIKE CONCAT ('%',#{teacherForm.jobTitle},'%')
            </if>
            <if test="teacherForm.gender != null and teacherForm.gender != ''">
                AND gender = #{teacherForm.gender}
            </if>
            <if test="teacherForm.subjectId != null and teacherForm.subjectId != ''">
                AND subject_id = #{teacherForm.subjectId}
            </if>
            <if test="teacherForm.departmentId null and teacherForm.departmentId != ''">
                AND department_id = #{teacherForm.departmentId}
            </if>
        </where>
    </select>
</mapper>